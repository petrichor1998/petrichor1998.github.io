<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Understanding Logistic Regression and Naive Bayes | Parth Padalkar</title> <meta name="author" content="Parth Padalkar"> <meta name="description" content="Coding the Logistic Regression and Naive Bayes classifier from scratch and analyzing the performance on identifying Ham vs Spam email."> <meta name="keywords" content="NeSyFOLD, ML, AL, NLP, XAI"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://petrichor1998.github.io/projects/lr_nb/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Parth </span>Padalkar</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About</a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">Blog</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/Projects/">Projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Understanding Logistic Regression and Naive Bayes</h1> <p class="post-description">Coding the Logistic Regression and Naive Bayes classifier from scratch and analyzing the performance on identifying Ham vs Spam email.</p> </header> <article> <h2 id="the-coding">The Coding</h2> <p>All the code was written in Python without using any of the pre-existing ML libraries such as tensorflow, sklearn, etc. The code can be found on my <a href="https://github.com/petrichor1998/NaiveBayesLogisticRegProject" rel="external nofollow noopener" target="_blank">GitHub</a>. The following are the highlights of the code:</p> <ol> <li>Implement the multinomial Naive Bayes algorithm for text classification described <a href="http://nlp.stanford.edu/IR-book/pdf/13bayes.pdf" rel="external nofollow noopener" target="_blank">here</a>:</li> <li>Implemented the discrete Naive Bayes algorithm with add-one laplace smoothing.</li> <li>Implement the MCAP Logistic Regression algorithm with L2 regularization.</li> <li>Used the SGDClassifier from scikit-learn for comparison.</li> </ol> <h2 id="the-experiments">The Experiments</h2> <p>Used the spam/ham used in the Metsis et al. paper @CEAS 2006.</p> <p>I converted the text data into a matrix of features × examples (namely our canonical data representation), using the following approaches.</p> <ol> <li>Bag of Words model: I used a vocabulary having w words (the set of all unique words in the training set) and represent each email using a vector of word frequencies (the number of times each word in the vocabulary appears in the email).</li> <li>Bernoulli model: As before I used a vocabulary having w words and represent each email (training example) using a 0/1 vector of length w where 0 indicates that the word does not appear in the email and 1 indicates that the word appears in the email.</li> </ol> <div class="row justify-content-sm-center"> <div class="col-sm-6 mt-3"> <figure> <picture> <img src="/assets/img/Projects/nb_lr/lr_bern.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="Lr with bernoulli model" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm-6 mt-3"> <figure> <picture> <img src="/assets/img/Projects/nb_lr/lr_bow.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="Image 2" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm-6 mt-3"> <figure> <picture> <img src="/assets/img/Projects/nb_lr/nb_bern.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="Image 3" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm-6 mt-3"> <figure> <picture> <img src="/assets/img/Projects/nb_lr/nb_bow.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="Image 4" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <h2 id="the-learnings">The Learnings</h2> <p>I like to categorize my learnings into two categories: The Profound and The Subtle. The Profound are the key questions that were answered through this project. The Subtle could be an intuition I had, insight I discovered or a clever python hack I learnt from this project. For example, <code class="language-plaintext highlighter-rouge">print</code> statement has a parameter called <code class="language-plaintext highlighter-rouge">end</code> which can be used to change the default newline character to something else.</p> <h3 id="the-profound">The Profound</h3> <p><strong>Q1. Which data representation and algorithm combination yields the best performance (mea- sured in terms of the accuracy, precision, recall and F1 score) and why?</strong> Naïve bayes yields the best performance with the bag of words model (~94% accuracy) because it has the frequency of the words which gives serves as better feature values than the simple 0/1 values in the Bernoulli model. The logistic regression also performs well with the bag of words model but not as well as the naïve bayes. The bag of words model is better than the Bernoulli model because it has more information about the words in the email.</p> <p><strong>Q2. How does the size of the vocabulary impact the performance of the classifiers?</strong> The size of the vocabulary impacts the performance of the classifiers. The performance of the classifiers decreases as the size of the vocabulary increases. Since there are more features that are added to the model, the model becomes more complex and the curse of dimensionality comes into play.</p> <p><strong>Q4. How does the performance of the classifiers compare to the performance of the scikit-learn classifiers?</strong></p> <p>The performance of the classifiers is comparable to the performance of the scikit-learn classifiers. The scikit-learn classifiers are faster.</p> <h3 id="the-subtle">The Subtle</h3> <ol> <li>The SGDClassifier from scikit-learn is very fast and gives good results. The libraries are optimized for runtime and are very efficient.</li> <li>A simple classifier like Naive Bayes can give very good results on text data. The frequency of the words is a good feature value for the classifier.</li> </ol> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2024 Parth Padalkar. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>