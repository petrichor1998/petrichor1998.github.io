<!DOCTYPE html> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>NeurASP: Embracing Neural Networks into Answer Set Programming | Parth Padalkar</title> <meta name="author" content="Parth Padalkar"> <meta name="description" content="A Neurosymbolic framework that combines Neural networks and Answer Set Programming"> <meta name="keywords" content="NeSyFOLD, ML, AL, NLP, XAI"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://petrichor1998.github.io/blog/2023/neurasp/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src="/assets/js/distillpub/template.v2.js"></script> <script src="/assets/js/distillpub/transforms.v2.js"></script> <script src="/assets/js/distillpub/overrides.js"></script> </head> <body> <d-front-matter> <script async type="text/json">{
      "title": "NeurASP: Embracing Neural Networks into Answer Set Programming",
      "description": "A Neurosymbolic framework that combines Neural networks and Answer Set Programming",
      "published": "February 13, 2023",
      "authors": [
        {
          "author": "Parth Padalkar",
          "authorURL": "",
          "affiliations": [
            {
              "name": "UT Dallas",
              "url": ""
            }
          ]
        }
        
      ],
      "katex": {
        "delimiters": [
          {
            "left": "$",
            "right": "$",
            "display": false
          },
          {
            "left": "$$",
            "right": "$$",
            "display": true
          }
        ]
      }
    }</script> </d-front-matter> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Parth </span>Padalkar</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">Blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/Projects/">Projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="post distill"> <d-title> <h1>NeurASP: Embracing Neural Networks into Answer Set Programming</h1> <p>A Neurosymbolic framework that combines Neural networks and Answer Set Programming</p> </d-title> <d-byline></d-byline> <d-article> <h2 id="introduction">Introduction</h2> <p>NeurASP <d-cite key="neurasp"></d-cite> is a framework that aims to combine the power of Answer Set Programming and neural networks. <a href="https://en.wikipedia.org/wiki/Answer_set_programming" rel="external nofollow noopener" target="_blank">Answer Set Progrramming</a> (ASP) is a form of declarative programming used to solve search, planning and combinatorial problems. It is also used for automating commonsense reasoning.</p> <p>In this paper there are mainly 2 ideas that the authors explore which are:</p> <ol> <li>Using pretrained neural network in symbolic computation to improve the neural network’s perception result</li> <li>Training a neural network from scratch using ASP rules as constraints.</li> </ol> <p>A neural atom <code class="language-plaintext highlighter-rouge">nn()</code> is introduced which represents a neural network in ASP. The idea is to use this atom to invoke a neural network whenever needed inside the ASP program. Some example code to using the neural atom is shown below:</p> <div class="language-prolog highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="ss">img</span><span class="p">(</span><span class="ss">d1</span><span class="p">).</span> <span class="ss">img</span><span class="p">(</span><span class="ss">d2</span><span class="p">).</span>
<span class="ss">nn</span><span class="p">(</span><span class="ss">digit</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="nv">X</span><span class="p">),</span> <span class="p">[</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">4</span><span class="p">,</span><span class="m">5</span><span class="p">,</span><span class="m">6</span><span class="p">,</span><span class="m">7</span><span class="p">,</span><span class="m">8</span><span class="p">,</span><span class="m">9</span><span class="p">])</span> <span class="p">:-</span> <span class="ss">img</span><span class="p">(</span><span class="nv">X</span><span class="p">).</span>
<span class="ss">addition</span><span class="p">(</span><span class="nv">A</span><span class="p">,</span><span class="nv">B</span><span class="p">,</span><span class="nv">N</span><span class="p">)</span> <span class="p">:-</span> <span class="ss">digit1</span><span class="p">(</span><span class="nv">A</span><span class="p">)</span> <span class="o">=</span> <span class="nv">N1</span><span class="p">,</span> <span class="ss">digit1</span><span class="p">(</span><span class="nv">B</span><span class="p">)</span> <span class="o">=</span> <span class="nv">N2</span><span class="p">,</span> <span class="nv">N</span> <span class="o">=</span> <span class="nv">N1</span> <span class="o">+</span> <span class="nv">N2</span><span class="p">.</span>
</code></pre></div></div> <h2 id="learning">Learning</h2> <p>The <code class="language-plaintext highlighter-rouge">digit1()</code> is an atom that the <code class="language-plaintext highlighter-rouge">nn(digit(1, X), [0,1,2,3,4,5,6,7,8,9])</code> atom is distilled to. In the backend, it is broken down into 10 atoms, one for each digit. The rules above simply state that <code class="language-plaintext highlighter-rouge">d1</code> and <code class="language-plaintext highlighter-rouge">d2</code> are 2 images of digits, <code class="language-plaintext highlighter-rouge">digit</code> is the neural network used for the digit classification and the expected output can be any number <code class="language-plaintext highlighter-rouge">[0,1,2,3,4,5,6,7,8,9]</code> and the addition of the 2 digits is <code class="language-plaintext highlighter-rouge">A</code>. A probability is then associated with each atom <code class="language-plaintext highlighter-rouge">digit1(n)</code> where <code class="language-plaintext highlighter-rouge">n</code> is a digit, which is simply the output of the neural network. The above program solves the problem of adding 2 digits from images.</p> <p>Now, to find the sum of two numbers the query in ASP in <a href="https://potassco.org/clingo/" rel="external nofollow noopener" target="_blank">clingo</a> syntax is given as a constraint <code class="language-plaintext highlighter-rouge">:- addition(A,B,1)</code>. This query implies that the sum of the 2 digits should be 1. This is what the authors call the observation. Clingo then finds the stable models that satisfy the constraints which are the solution.</p> <p>The probability of these stable models can be calculated using the following formula: \(\begin{equation}\label{eq_1} P_{\Pi}(I) = \begin{cases} \frac{\prod_{(c = v)} P_{\Pi}(c = v)}{NumStableModels},&amp; \text{if } I \text{ is a stable model of } \Pi \\ 0, &amp; \text{otherwise}\\ \end{cases} \end{equation}\)</p> <p>in \eqref{eq_1}, $P_{\Pi}(I)$ is the probability of the stable model $I$ given the program $\Pi$. The probability of the observation is simply the sum of probabilities of all the stable models that satisfy the observation. Then the objective becomes to maximize the probability of the observation. Hence gradient ascent!</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/learning_in_neurasp.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Learning and gradient propogation in NeurASP </div> <p>In the above figure the red arrow indicates the gradient calculateion of the ASP program w.r.t the neural network outputs. This is calculated by using a formula given by the authors in the paper. Since the program is not continuous the gradient is difficult to calculate. The orange arrow indicates the calculateion of gradients of the outputs of the neural network w.r.t the network parameters. This is simply done using backpropogation.</p> <h2 id="inference">Inference</h2> <p>The inference procedure is straightforward wherein a trained neural network is used through the <code class="language-plaintext highlighter-rouge">nn()</code> atom in the ASP program to solve the problem.</p> <h2 id="pros">Pros</h2> <ol> <li>The impovement paper shows over DeepProblog <d-cite key="deepproblog"></d-cite> is notable. There is a significant improvement in terms of convergence time.</li> <li>Seemless integration and a strong proposition for combining neural networks and ASP in the training loop.</li> <li>ASP is more expressive than prolog so it could be seen as a slight advantage over DeepProblog which uses prolog like semantics in terms of knowledge representation.</li> </ol> <h2 id="cons">Cons</h2> <ol> <li>No theoretical proof to show that the given proposition for gradient calculation is correct and is optimal. (Atleast for me it seems like there is some exposition into the insight behind this is needed here.)</li> <li>SCALABILITY is a big issue. It is simply not scalable for bigger and more complex problems since ASP is used. ASP solvers like CLINGO ground the whole program and then find the stable models which simply becomes intractable.</li> </ol> <p>This framework falls under the Symbolic[Neuro] category of neurosymbolic systems according to the taxonomy given by Henry Kautz <d-cite key="NeSytaxonomy"></d-cite>. Here the neural network is being used as a part of the ASP semantics.</p> </d-article> <d-appendix> <d-footnote-list></d-footnote-list> <d-citation-list></d-citation-list> </d-appendix> <d-bibliography src="/assets/bibliography/2018-12-22-distill.bib"></d-bibliography><div id="giscus_thread" style="max-width: 800px; margin: 0 auto;"> <script>let giscusTheme=localStorage.getItem("theme"),giscusAttributes={src:"https://giscus.app/client.js","data-repo":"alshedivat/al-folio","data-repo-id":"MDEwOlJlcG9zaXRvcnk2MDAyNDM2NQ==","data-category":"Comments","data-category-id":"DIC_kwDOA5PmLc4CTBt6","data-mapping":"title","data-strict":"1","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"bottom","data-theme":giscusTheme,"data-lang":"en",crossorigin:"anonymous",async:""},giscusScript=document.createElement("script");Object.entries(giscusAttributes).forEach(([t,a])=>giscusScript.setAttribute(t,a)),document.getElementById("giscus_thread").appendChild(giscusScript);</script> <noscript>Please enable JavaScript to view the <a href="http://giscus.app/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by giscus.</a> </noscript> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2024 Parth Padalkar. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>